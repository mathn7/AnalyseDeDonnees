<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Sujet TP3 · CSAD.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.jpg" alt="CSAD.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">CSAD.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Accueil</a></li><li><a class="tocitem" href="../Projet/">Projet</a></li><li><a class="tocitem" href="../sujet_tp1/">Sujet TP1</a></li><li><a class="tocitem" href="../sujet_tp2/">Sujet TP2</a></li><li class="is-active"><a class="tocitem" href>Sujet TP3</a><ul class="internal"><li><a class="tocitem" href="#Exercice-1-Calcul-de-la-couleur-moyenne-d’une-image"><span>Exercice 1 - Calcul de la couleur moyenne d’une image</span></a></li><li><a class="tocitem" href="#Exercice-2-Estimation-de-la-vraisemblance-de-chaque-espèce-de-fleurs"><span>Exercice 2 - Estimation de la vraisemblance de chaque espèce de fleurs</span></a></li><li><a class="tocitem" href="#Exercice-3-Classification-d’images-de-fleurs"><span>Exercice 3 - Classification d’images de fleurs</span></a></li><li><a class="tocitem" href="#Pour-aller-plus-loin-(facultatif-)-Amélioration-du-classifieur"><span>Pour aller plus loin (facultatif ) - Amélioration du classifieur</span></a></li></ul></li><li><a class="tocitem" href="../sujet_tp4/">Sujet TP4</a></li><li><a class="tocitem" href="../fct_index/">Documentation des fonctions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Sujet TP3</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Sujet TP3</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/mathn7/Projet-CSAD/blob/master/docs/src/sujet_tp3.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Classification-bayésienne"><a class="docs-heading-anchor" href="#Classification-bayésienne">Classification bayésienne</a><a id="Classification-bayésienne-1"></a><a class="docs-heading-anchor-permalink" href="#Classification-bayésienne" title="Permalink"></a></h1><p>L’objectif est de réaliser un classifieur bayésien permettant de <strong>classer</strong> les images de trois espèces de fleurs (ne recopiez pas les images, afin de préserver votre quota). Lancez le script <em>recup_donnees.jl</em>, qui affiche des images de pensées, d’œillets et de chrysanthèmes. Vous constatez que ces images n’ont pas toutes la même taille.</p><p><img src="../assets/fleurs.png" alt/></p><p><span>$\hspace*{3.5cm}$</span> FIGURE 1 - De gauche à droite : pensée, œillet, chrysanthème.</p><h2 id="Exercice-1-Calcul-de-la-couleur-moyenne-d’une-image"><a class="docs-heading-anchor" href="#Exercice-1-Calcul-de-la-couleur-moyenne-d’une-image">Exercice 1 - Calcul de la couleur moyenne d’une image</a><a id="Exercice-1-Calcul-de-la-couleur-moyenne-d’une-image-1"></a><a class="docs-heading-anchor-permalink" href="#Exercice-1-Calcul-de-la-couleur-moyenne-d’une-image" title="Permalink"></a></h2><p>Dans un premier temps, vous allez classer les images selon la couleur moyenne de chaque espèce de fleurs. Pour cela, les trois niveaux de couleur <span>$(R, V, B) \in [0, 255]^{3}$</span> , en chaque pixel de chaque image, sont d’abord transformés en <strong>niveaux de couleur normalisés</strong> <span>$(r, v, b)$</span>, qui sont définis de la manière suivante :</p><p><span>$\hspace*{2.5cm}$</span> <span>$(r, v, b) = \frac{1}{max\{1,R+V+B\}}(R,V,B) \\$</span></p><p>Le principal intérêt des niveaux de couleur normalisés est que deux valeurs parmi <span>$(r, v, b)$</span> permettent de déduire la troisième, puisque <span>$r+v+b = 1$</span>, sauf dans le cas exceptionnel où <span>$(r, v, b) = (0, 0, 0)$</span>. Une image est donc caractérisée par les moyennes <span>$(\bar{r}, \bar{v}, \bar{b})$</span>, ou plus simplement par <span>$(\bar{r},\bar{v})$</span>,  puisque <span>$\bar{r}+\bar{v}+\bar{b}=1$</span>, c’est-à-dire par un vecteur <span>$x = (\bar{r},\bar{v}) \in \mathbb{R}^2$</span> que l’on  appelle sa <strong>couleur moyenne</strong>. Compte tenu des différences de couleurs moyennes entre les trois espèces de fleurs,  on postule que ce vecteur suffira à les distinguer.</p><div class="admonition is-warning"><header class="admonition-header">Travail à effectuer</header><div class="admonition-body"><p>Écrivez la fonction moyenne, qui calcule la couleur moyenne d’une image, c’est-à-dire <span>$x^{T} = (\bar{r},\bar{v})$</span> dans un vecteur ligne,  sans oublier de convertir les niveaux de couleur <span>$(R, V, B)$</span> auformat single (pour manipuler des réels) et de les normaliser.</p></div></div><p>Le script <em>exercice_1.jl</em> regroupe dans trois tableaux de données <em>X_pensees</em>, <em>X_oeillets</em> et <em>X_chrysanthemes</em> les valeurs moyennes calculées  avec la fonction précédente pour chaque groupe d’images. Il affiche ensuite les couleurs moyennes de l’ensemble des images de fleurs sous la forme de trois nuages de points de <span>$\mathbb{R}^2$</span> avec trois couleurs et symboles différents.</p><h4 id="Question"><a class="docs-heading-anchor" href="#Question">Question</a><a id="Question-1"></a><a class="docs-heading-anchor-permalink" href="#Question" title="Permalink"></a></h4><p>Au regard de cette figure, la couleur moyenne vous semble-t-elle une caractéristique suffisamment discriminante de ces trois espèces de fleurs ?</p><h2 id="Exercice-2-Estimation-de-la-vraisemblance-de-chaque-espèce-de-fleurs"><a class="docs-heading-anchor" href="#Exercice-2-Estimation-de-la-vraisemblance-de-chaque-espèce-de-fleurs">Exercice 2 - Estimation de la vraisemblance de chaque espèce de fleurs</a><a id="Exercice-2-Estimation-de-la-vraisemblance-de-chaque-espèce-de-fleurs-1"></a><a class="docs-heading-anchor-permalink" href="#Exercice-2-Estimation-de-la-vraisemblance-de-chaque-espèce-de-fleurs" title="Permalink"></a></h2><p>Les trois nuages de points précédents peuvent être modélisés par des lois normales bidimensionnelles. Il est rappelé que la densité de probabilité d’une loi normale s’écrit, en dimension <span>$d$</span> :</p><p><span>$\hspace*{2.5cm}$</span> <span>$p(\mathbf{x})=\frac{1}{(2 \pi)^{d/2}(\operatorname{det} \Sigma)^{1/2}} \exp \left(-\frac{1}{2}(\mathbf{x}-\mu)^{\top} \Sigma^{-1}(\mathbf{x}-\mu)\right) \hspace*{2.0cm} (1) \\    \\$</span> où: <span>$\\$</span> <span>$\hspace*{1.5cm}$</span>  <span>$。\mu$</span> désigne l&#39;espérance (la moyenne) des vecteurs <span>$\mathbf{x} \in \mathbb{R}^{d}: \mu=E[\mathbf{x}]=\frac{1}{n} \mathbf{x}^{\top} \mathbf{1}_{n} \\    \\$</span> <span>$\hspace*{1.5cm}$</span>  <span>$。\Sigma$</span> désigne la matrice de variance/covariance : <span>$\Sigma=E\left[(\mathbf{x}-\mu)(\mathbf{x}-\mu)^{\top}\right]=\frac{1}{n}\left(\mathbf{x}^{c}\right)^{\top} \mathbf{x}^{c} \\$</span></p><p>Dans le cadre bayésien, la vraisemblance de la classe <span>$\omega_{i}$</span> associée à chaque type de fleur, qui est caractérisée par la moyenne <span>$\mu_{i}$</span> et la matrice de variance/covariance <span>$\Sigma_{i},$</span> peut être modélisée par une loi normale analogue à (1): <span>$\\$</span> <span>$\\ \hspace*{2.5cm}$</span> <span>$p\left(\mathbf{x}|\omega_{i}\right)=\frac{1}{(2 \pi)^{d / 2}\left(\operatorname{det} \Sigma_{i}\right)^{1 / 2}} \exp \left(-\frac{1}{2}\left(\mathbf{x}-\mu_{i}\right)^{\top} \Sigma_{i}^{-1}\left(\mathbf{x}-\mu_{i}\right)\right), \quad i \in[1,3] \\$</span></p><p>Il faut donc estimer les paramètres <span>$\mu_{i}$</span> et <span>$\Sigma_{i}$</span> des trois classes correspondant aux trois espèces de fleurs.<span>$\\$</span></p><div class="admonition is-warning"><header class="admonition-header">Travail à effectuer</header><div class="admonition-body"><p>Écrivez la fonction <em>estimation<em>mu</em>Sigma</em> permettant d’effectuer l’estimation empirique des paramètres d’une loi normale bidimensionnelle <span>$(d = 2)$</span> à partir d’une matrice de données <span>$X$</span>.</p></div></div><p>Le script <em>exercice_2.jl</em> estime les paramètres <span>$\mu_i$</span> et <span>$\Sigma_i$</span> des trois classes <span>$\omega_i$</span> correspondant aux trois espèces de fleurs, à partir des tableaux de données <em>X_pensees</em>, <em>X_oeillets</em> et <em>X_chrysanthemes</em>, puis superpose la vraisemblance de chaque classe (en perspective 3D) au nuage de points à partir duquel elle a été estimée.</p><h2 id="Exercice-3-Classification-d’images-de-fleurs"><a class="docs-heading-anchor" href="#Exercice-3-Classification-d’images-de-fleurs">Exercice 3 - Classification d’images de fleurs</a><a id="Exercice-3-Classification-d’images-de-fleurs-1"></a><a class="docs-heading-anchor-permalink" href="#Exercice-3-Classification-d’images-de-fleurs" title="Permalink"></a></h2><p>Nous souhaitons maintenant prédire à quelle espèce de fleurs une image requête, <span>$\mathbf{x}$</span>, doit être associée. Comme nous avons utilisé des données étiquetées (chacune des images étant associée à une espèce de fleurs), il s&#39;agit de <em>classification supervisée</em>. Un premier type de classification consiste à affecter à <span>$\mathbf{x}$</span> la classe <span>$\omega_{i}$</span> qui maximise la vraisemblance <span>$p\left(\mathbf{x} | \omega_{i}\right) .$</span> Il s&#39;agit alors d&#39;un classifieur par <em>maximum de vraisemblance</em>.</p><div class="admonition is-warning"><header class="admonition-header">Travail à effectuer</header><div class="admonition-body"><p>Modifiez le script <em>exercice_3.jl</em>, de manière à :</p><ol><li>partitionner le plan <span>$\mathbb{R}^2$</span> en trois parties correspondant aux trois classes de fleurs,</li><li>les colorier en trois couleurs différentes associées à celles des nuages de points,</li><li>afficher le pourcentage d’images bien classées sur l’ensemble des trois classes.</li></ol></div></div><p>Par ailleurs, la règle de Bayes donne l&#39;expression suivante de la probabilité <span>$a$</span> <strong>posteriori</strong> <span>$p\left(\omega_{i}|\mathbf{x}\right)$</span> c&#39;est-à-dire de la probabilité pour que la classe <span>$\omega_{i}$</span> contienne <span>$\mathbf{x}$</span> : <span>$\\$</span> <span>$\\ \hspace*{3.5cm}$</span> <span>$p\left(\omega_{i} | \mathbf{x}\right)=\frac{p\left(\mathbf{x}|\omega_{i}\right) p\left(\omega_{i}\right)}{p(\mathbf{x})} \hspace*{2.0cm} (2) \\$</span></p><p>Il semble naturel d&#39;affecter à x la classe <span>$\omega_{i}$</span> qui maximise <span>$p(\omega_{i}|\mathbf{x}) .$</span> Une telle classification est dite par <strong>maximum a posteriori</strong> (MAP). Sachant que le dénominateur <span>$p(\mathbf{x})$</span> de (2) est indépendant de <span>$\omega_{i},$</span> il n&#39;est pas nécessaire de le connaítre pour trouver le maximum des <span>$p(\omega_{i}|\mathbf{x})$</span>. En revanche, il est nécessaire de connaítre la <strong>probabilité a priori</strong> <span>$p\left(\omega_{i}\right)$</span> de chaque classe <span>$\omega_{i},$</span> faute de quoi on fait généralement l&#39;hypothèse que les classes sont équiprobables (l&#39;estimateur par maximum a <em>posteriori</em> revient alors à un estimateur par maximum de vraisemblance).</p><div class="admonition is-warning"><header class="admonition-header">Travail à effectuer</header><div class="admonition-body"><p>Écrivez une variante <em>exercice_3_bis.jl</em> du script <em>exercice_3.jl</em> où, en jouant sur les probabilités a <em>priori</em> des trois classes que vous ajouterez afin de classifier par maximum a posteriori et vous essaierez de maximiser le pourcentage d’images correctement classées.</p></div></div><h2 id="Pour-aller-plus-loin-(facultatif-)-Amélioration-du-classifieur"><a class="docs-heading-anchor" href="#Pour-aller-plus-loin-(facultatif-)-Amélioration-du-classifieur">Pour aller plus loin (facultatif ) - Amélioration du classifieur</a><a id="Pour-aller-plus-loin-(facultatif-)-Amélioration-du-classifieur-1"></a><a class="docs-heading-anchor-permalink" href="#Pour-aller-plus-loin-(facultatif-)-Amélioration-du-classifieur" title="Permalink"></a></h2><p>Même en jouant sur les probabilités <span>$a$</span> <em>priori</em>, le classifieur obtenu reste décevant, surtout pour pensées et les ceillets. En effet, l&#39;observation attentive des images de ces deux espèces, dont les couleurs moyennes sont similaires, montre qu&#39;elles ne sont pas structurées de la même façon : les pensées sont plus sombres au centre, c&#39;est-à-dire au niveau du pistil, par rapport aux ceillets. Cela suggère de ne pas seulement calculer la couleur moyenne des images, mais de scinder chaque image en deux parties complémentaires: le centre <span>$C$</span> (notion à préciser) et le pourtour <span>$P$</span> (complémentaire de <span>$C$</span> ).</p><p>Écrivez un script <em>exercice_4.jl</em> reprenant le principe du classifieur MAP de l&#39;exercice 3, mais utilisant trois caractéristiques au lieu de deux pour décrire une image, à savoir le couple de valeurs <span>$(\bar{r}, \bar{v})$</span> calculées sur le pourtour <span>$P$</span> et la valeur <span>$\bar{r}$</span> calculée sur le centre <span>$C$</span>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../sujet_tp2/">« Sujet TP2</a><a class="docs-footer-nextpage" href="../sujet_tp4/">Sujet TP4 »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 1 July 2020 16:42">Wednesday 1 July 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
